function bigPlay(){video.paused?(video.play(),bigPlayWrap.setAttribute("class","hidden")):(video.pause(),bigPlayWrap.setAttribute("class","visible"))}function playPause(){video.paused||video.ended?video.play():video.pause(),1!==video.playbackRate&&(video.playbackRate=1)}function frameForward(e){var t=24,a=1/t,r=a*e;video.paused?video.currentTime+=r:video.pause()}function frameBackward(e){var t=24,a=1/t,r=a*e;video.paused?video.currentTime-=r:video.pause()}function keyForward(){var e=video.currentTime,t,a;keyFrames.push(e),keyFrames.sort(function(e,t){return e-t}),a=keyFrames.indexOf(e),t=keyFrames[a+1],t===e&&(t=keyFrames[a+2]),keyFrames.splice(a,1),t&&(video.currentTime=t)}function keyBackward(){var e=video.currentTime,t,a;keyFrames.push(e),keyFrames.sort(function(e,t){return e-t}),a=keyFrames.indexOf(e),t=keyFrames[a-1],t===e&&(t=keyFrames[a+2]),keyFrames.splice(a,1),t&&(video.currentTime=t)}function addKeyFrame(){var e=video.currentTime;-1===keyFrames.indexOf(e)&&keyFrames.push(e);var t=document.createElement("div"),a=e/progress.max*100;t.style.marginLeft=a.toFixed(3)+"%",t.style.marginLeft=a.toFixed(3)+"%",t.dataset.timecode=e,keyTicks.appendChild(t)}function toggleLoop(){video.loop?video.loop=!1:(video.loop=!0,loop.className="btn inactive"),"btn"===loop.className?loop.className="btn inactive":loop.className="btn"}function toggleFullScreen(){video.requestFullscreen?video.requestFullscreen():video.msRequestFullscreen?video.msRequestFullscreen():video.mozRequestFullScreen?video.mozRequestFullScreen():video.webkitRequestFullscreen&&video.webkitRequestFullscreen()}function jogForward(){video.paused&&playPause(),1===video.playbackRate?video.playbackRate=2:video.playbackRate+=1}var supportsVideo=!!document.createElement("video").canPlayType,playerWrap=document.getElementById("flipbook-js"),playerOuter=document.getElementById("player-outer"),playerControls=document.getElementById("controls-wrap"),controlsOuter=document.getElementById("controls-outer"),controlsInner=document.getElementById("controls-inner"),video=document.getElementById("video"),playpause=document.getElementById("play-pause"),playIcon=document.getElementById("i-play"),pauseIcon=document.getElementById("i-pause"),bigplay=document.getElementById("big-play"),bigPlayWrap=document.getElementById("big-play-wrap"),frameforward=document.getElementById("frame-forward"),framebackward=document.getElementById("frame-backward"),loop=document.getElementById("loop"),fullscreen=document.getElementById("fullscreen"),addKeyFrameBtn=document.getElementById("keyframe"),keyTicks=document.getElementById("keyframe-ticks"),progressOuter=document.getElementById("progress-outer"),progress=document.getElementById("progress"),progressBar=document.getElementById("progress-bar"),keyBackBtn=document.getElementById("keyleft"),keyForwardBtn=document.getElementById("keyright"),keyFrames=[];playerOuter.addEventListener("mouseenter",function(){""===playerControls.className&&"visible"!=bigPlayWrap.className&&(playerControls.className=playerControls.className+"active")}),playerOuter.addEventListener("mouseleave",function(){"active"===playerControls.className&&(playerControls.className="")}),supportsVideo&&(video.controls=!1,playerOuter.addEventListener("keydown",function(e){32===e.keyCode||75===e.keyCode?(e.preventDefault(),playPause()):37===e.keyCode||189===e.keyCode?(e.preventDefault(),frameBackward(1)):39===e.keyCode||187===e.keyCode?(e.preventDefault(),frameForward(1)):38===e.keyCode?(e.preventDefault(),keyForward()):40===e.keyCode?(e.preventDefault(),keyBackward()):76===e.keyCode?jogForward():70===e.keyCode||191===e.keyCode?addKeyFrame():68===e.keyCode?keyBackward():73===e.keyCode&&keyForward()}),bigPlayWrap.addEventListener("click",function(){bigPlay()}),video.addEventListener("click",function(){playPause()}),playpause.addEventListener("click",function(){playPause()}),frameforward.addEventListener("click",function(){frameForward(1)}),framebackward.addEventListener("click",function(){frameBackward(1)}),loop.addEventListener("click",function(){toggleLoop()}),fullscreen.addEventListener("click",function(){toggleFullScreen()}),video.addEventListener("loadedmetadata",function(){progress.setAttribute("max",video.duration)}),video.addEventListener("timeupdate",function(){progress.getAttribute("max")||progress.setAttribute("max",video.duration),progress.value=video.currentTime,progressBar.style.width=Math.floor(video.currentTime/video.duration*100)+"%",video.paused||video.ended?(playIcon.setAttribute("class","visible"),pauseIcon.setAttribute("class","hidden")):(pauseIcon.setAttribute("class","visible"),playIcon.setAttribute("class","hidden"))}),progressOuter.addEventListener("click",function(e){var t=playerOuter.offsetLeft+progressBar.offsetLeft,a=(e.pageX-t)/progress.offsetWidth,r=a*video.duration;video.currentTime=r}),keyForwardBtn.addEventListener("click",function(){keyForward()}),keyBackBtn.addEventListener("click",function(){keyBackward()}),addKeyFrameBtn.addEventListener("click",function(){addKeyFrame()}));